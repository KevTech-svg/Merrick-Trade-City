<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Merrick Trade City â€” Admin Panel</title>
<link rel="icon" type="image/png" href="A_logo_for_Merrick_Trade_City_is_displayed_against.png.jpg">
<style>
  :root{--bg:#0a1025;--accent:#7c5cff;--accent2:#ff6b6b;}
  body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:#fff;display:flex;min-height:100vh}
  .sidebar{width:220px;background:linear-gradient(180deg,#7c5cff,#0f0c29);padding:18px;display:flex;flex-direction:column;gap:12px}
  .sidebar h2{margin:0;text-align:center}
  .sidebar button{background:none;border:none;color:#fff;padding:8px;text-align:left;cursor:pointer;border-radius:6px;transition:.3s}
  .sidebar button:hover{background:rgba(255,255,255,0.1)}
  .main{flex:1;padding:18px;display:flex;flex-direction:column;gap:14px}
  .summary{display:flex;gap:14px;flex-wrap:wrap}
  .card{background:rgba(255,255,255,0.04);padding:12px;border-radius:10px;flex:1}
  .charts{display:flex;gap:14px;flex-wrap:wrap}
  canvas{background:transparent;border-radius:8px}
  .top-right{display:flex;gap:8px;align-items:center}
  .btn{padding:8px 10px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#ddd}
  .btn-primary{background:linear-gradient(90deg,#7c5cff,#ff6b6b);color:#fff}
  table{width:100%;border-collapse:collapse;color:#ddd}
  th,td{padding:6px;border-bottom:1px solid rgba(255,255,255,0.1)}
  input{padding:8px;border-radius:6px;border:none;background:rgba(255,255,255,0.05);color:#fff;width:100%}
  label{font-size:.9rem;color:#ccc}
  .hidden{display:none}
</style>
</head>
<body>
<div class="sidebar">
  <h2>Merrick Admin</h2>
  <button data-section="dashboard">Dashboard</button>
  <button data-section="users">Users</button>
  <button data-section="bots">Bots</button>
  <button data-section="transactions">Transactions</button>
  <button data-section="settings">Settings</button>
  <div style="margin-top:auto">
    <button id="logoutBtn" class="btn btn-ghost">Logout</button>
  </div>
</div>

<div class="main">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h1 style="margin:0;font-size:1.3rem">Admin Dashboard</h1>
    <div class="top-right"><div id="adminEmailDisplay" style="opacity:0.8"></div></div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="section">
    <div class="summary">
      <div class="card"><h3>Total Users</h3><p id="totalUsers">0</p></div>
      <div class="card"><h3>Total Bots</h3><p id="totalBots">0</p></div>
      <div class="card"><h3>Total Balance</h3><p id="totalBalance">Ksh 0</p></div>
    </div>
    <div class="charts">
      <div class="card" style="flex:1;min-width:300px">
        <h4>Bot Categories</h4>
        <canvas id="botCategoryChart"></canvas>
      </div>
      <div class="card" style="flex:1;min-width:300px">
        <h4>Transactions (Ksh)</h4>
        <canvas id="transactionsChart"></canvas>
      </div>
    </div>
  </div>

  <!-- USERS -->
  <div id="users" class="section hidden">
    <div class="card">
      <h3>Registered Users</h3>
      <table>
        <thead><tr><th>Name</th><th>Email</th><th>Balance</th><th>Activity</th></tr></thead>
        <tbody id="usersTable">
          <tr><td>Kelvin Njuguna</td><td>kelvin@example.com</td><td>Ksh 250</td><td>Active</td></tr>
          <tr><td>Jane Doe</td><td>jane@example.com</td><td>Ksh 0</td><td>Inactive</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- BOTS -->
  <div id="bots" class="section hidden">
    <div class="card">
      <h3>Upload Bot</h3>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <input id="botName" placeholder="Bot name">
        <input id="botCategory" placeholder="Category">
        <input id="botPrice" type="number" placeholder="Price (Ksh)">
        <button class="btn btn-primary" id="uploadBot">Upload</button>
      </div>
    </div>
  </div>

  <!-- TRANSACTIONS -->
  <div id="transactions" class="section hidden">
    <div class="card">
      <h3>Transactions</h3>
      <table>
        <thead><tr><th>User</th><th>Bot</th><th>Amount</th><th>Date</th></tr></thead>
        <tbody id="txBody">
          <tr><td>Kelvin</td><td>GoldBot</td><td>Ksh 800</td><td>22 Oct 2025</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- SETTINGS -->
  <div id="settings" class="section hidden">
    <div class="card">
      <h3>Settings</h3>
      <label for="mpesa">M-Pesa Number</label>
      <input id="mpesa" value="0712345678" />
      <label for="budget">Budget Wallet Address</label>
      <input id="budget" value="0x0000000000000000000000000000000000000000" />
      <label for="settingsPass">Confirm with Settings Password</label>
      <input id="settingsPass" type="password" placeholder="Enter settings password">
      <div style="margin-top:12px">
        <button id="saveSettings" class="btn btn-primary">Save Changes</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ADMIN_KEY = 'merrick_admin';
const SETTINGS_PASSWORD = 'AdminSecure@2025'; // Password to authorize settings changes

/* Session Check */
const session = localStorage.getItem(ADMIN_KEY);
if(!session){
  alert('You must log in as admin.');
  location.href = 'index.html';
}
try{
  const data = JSON.parse(session);
  document.getElementById('adminEmailDisplay').textContent = data.email || 'Admin';
}catch(e){ location.href='index.html'; }

/* Navigation */
const buttons = document.querySelectorAll('.sidebar button[data-section]');
const sections = document.querySelectorAll('.section');
buttons.forEach(btn => {
  btn.addEventListener('click', ()=>{
    const target = btn.dataset.section;
    sections.forEach(sec => sec.classList.add('hidden'));
    document.getElementById(target).classList.remove('hidden');
  });
});

/* Logout */
document.getElementById('logoutBtn').addEventListener('click', ()=>{
  localStorage.removeItem(ADMIN_KEY);
  alert('Logged out.');
  location.href='index.html';
});

/* Upload bot (demo only) */
document.getElementById('uploadBot').addEventListener('click', ()=>{
  const name=document.getElementById('botName').value||'Unnamed';
  const cat=document.getElementById('botCategory').value||'General';
  const price=document.getElementById('botPrice').value||'0';
  const row=document.createElement('tr');
  row.innerHTML=`<td>Admin</td><td>${name}</td><td>Ksh ${price}</td><td>${new Date().toLocaleDateString()}</td>`;
  document.getElementById('txBody').prepend(row);
  alert('Bot uploaded: '+name);
});

/* Save Settings */
document.getElementById('saveSettings').addEventListener('click', ()=>{
  const entered = document.getElementById('settingsPass').value.trim();
  if(entered !== SETTINGS_PASSWORD){
    alert('Incorrect settings password.');
    return;
  }
  const mpesa=document.getElementById('mpesa').value;
  const budget=document.getElementById('budget').value;
  localStorage.setItem('admin_settings', JSON.stringify({ mpesa, budget }));
  alert('Settings saved successfully.');
});

/* Charts */
const botChart=new Chart(document.getElementById('botCategoryChart'),{
  type:'bar',
  data:{labels:['Forex','Crypto','Stocks'],datasets:[{data:[5,3,2],backgroundColor:['#7c5cff','#ff6b6b','#1dd1a1']}]},
  options:{plugins:{legend:{display:false}}}
});
const txChart=new Chart(document.getElementById('transactionsChart'),{
  type:'bar',
  data:{labels:['Mon','Tue','Wed','Thu','Fri'],datasets:[{label:'Ksh',data:[100,200,150,300,250],backgroundColor:'#7c5cff'}]},
  options:{scales:{y:{beginAtZero:true}}}
});
</script>
</body>
</html>
